<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js">/*global define */
define( [
	'jquery',
	'lodash',
	'jqc/ComponentManager',
	'jqc/Container'
], function( jQuery, _, ComponentManager, Container ) {

<span id='jqc-Viewport'>	/**
</span>	 * @class jqc.Viewport
	 * @extends jqc.Container
	 *  
	 * A special {@link jqc.Container Container} which keeps itself at the size of its parent element, and responds to window resizes
	 * to re-layout its child {@link jqc.Component Components}.
	 * 
	 * Ideally, there should only be one Viewport on a page, and it should automatically be rendered into the document body.
	 * However, until everything uses the UI framework, this is used on an individual basis in some areas. 
	 * 
	 * Note that a Viewport should not contain another Viewport though. A set of parent/child relationships should end at the
	 * top with a Viewport, and all children should simply be {@link jqc.Container Containers}. If they need to be sized to 100% height/width,
	 * their parent {@link jqc.Container Container} should be configured with a {@link jqc.layout.Fit FitLayout}.
	 */
	var Viewport = Container.extend( {
		
<span id='jqc-Viewport-cfg-layout'>		/**
</span>		 * @cfg
		 * @inheritdoc
		 */
		layout : 'fit',
		
		
<span id='jqc-Viewport-property-onWindowResizeDelegate'>		/**
</span>		 * @private
		 * @property {Function} onWindowResizeDelegate
		 * 
		 * The delegate function which is a handler of the window resize event. This reference must
		 * be stored so that it can be unbound when the Viewport is destroyed.
		 */
		
		
<span id='jqc-Viewport-method-initComponent'>		/**
</span>		 * @inheritdoc
		 */
		initComponent : function() {
			this._super( arguments );
			
			this.onWindowResizeDelegate = _.debounce( _.bind( this.onWindowResize, this ), 150 );
			jQuery( window ).bind( 'resize', this.onWindowResizeDelegate );
		},
		
		
<span id='jqc-Viewport-method-onRender'>		/**
</span>		 * @inheritdoc
		 */
		onRender : function() {
			this._super( arguments );
			
			this.$el.css( {
				position     : 'relative',
				'overflow-x' : 'hidden',
				'overflow-y' : 'auto'
			} );
			
			this.recalcDimensions();
		},
		
		
<span id='jqc-Viewport-method-recalcDimensions'>		/**
</span>		 * Recalculates and sets the dimensions of the Viewport to the size of its parent element.
		 * 
		 * @private
		 */
		recalcDimensions : function() {
			if( this.rendered ) {
				var $el = this.$el,
				    $parent = $el.parent();
				    
				$el.css( {
					width: $parent.width(),
					height: $parent.height()
				} );
			}
		},
		
		
<span id='jqc-Viewport-method-onWindowResize'>		/**
</span>		 * Handler for when the window is resized. Re-calculates the dimensions of the Viewport,
		 * and runs {@link #doLayout}.
		 * 
		 * @protected
		 */
		onWindowResize : function() {
			if( !this.destroyed ) {  // just in case the viewport has been destroyed, but a window resize had previously been deferred
				this.doResize();
			}
		},
		
		
<span id='jqc-Viewport-method-doResize'>		/**
</span>		 * Performs a resize of the Viewport and a layout of its {@link #childComponents} in response to the buffered
		 * window resize task.
		 * 
		 * @protected
		 * @method doResize
		 */
		doResize : function() {
			this.recalcDimensions();
			this.doLayout();
		},
		
		
		// -----------------------------
		
		
<span id='jqc-Viewport-method-onDestroy'>		/**
</span>		 * @inheritdoc
		 */
		onDestroy : function() {
			jQuery( window ).unbind( 'resize', this.onWindowResizeDelegate );
			
			this._super( arguments );
		}
		
	} );
	
	
	// Register the type so it can be created by the type string 'Viewport'
	ComponentManager.registerType( 'Viewport', Viewport );
	
	return Viewport;
	
} );</pre>
</body>
</html>
