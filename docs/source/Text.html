<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js">/*global define */
define( [
	'jquery',
	'lodash',
	'jqGui/util/Html',
	'jqGui/ComponentManager',
	'jqGui/form/field/Field'
], function( jQuery, _, Html, ComponentManager, Field ) {
	
<span id='jqGui-form-field-Text'>	/**
</span>	 * @class jqGui.form.field.Text
	 * @extends jqGui.form.field.Field
	 * @alias type.textfield
	 * 
	 * Text field component.
	 */
	var TextField = Field.extend( {
		
<span id='jqGui-form-field-Text-cfg-selectOnFocus'>		/**
</span>		 * @cfg {Boolean} selectOnFocus
		 * 
		 * True to have the field's text automatically selected when the field is focused. Defaults to false. 
		 */
		selectOnFocus : false,
		
<span id='jqGui-form-field-Text-cfg-emptyText'>		/**
</span>		 * @cfg {String} emptyText
		 * 
		 * The text to show in the field when the field is empty. When the user enters something into the field, this 
		 * text will be removed. If the field becomes empty again, this text will be re-shown.
		 * 
		 * The implementation of the emptyText itself is an element that is placed over the field when the field is empty.
		 * This is done instead of putting in &quot;placeholder&quot; text so that the emptyText can easily be styled, and so that
		 * on older browsers that don't support the HTML5 &quot;placeholder&quot; attribute (IE8), the field doesn't need to have a
		 * value of the {@link #emptyText}.
		 */
		emptyText : &quot;&quot;,
		
<span id='jqGui-form-field-Text-cfg-value'>		/**
</span>		 * @cfg {String} value
		 * 
		 * The initial value for the field, if any.
		 */
		
<span id='jqGui-form-field-Text-cfg-readOnly'>		/**
</span>		 * @cfg {Boolean} readOnly
		 * 
		 * True to mark the Field as &quot;read only&quot; in the HTML. This prevents the user from editing the Field.
		 */
		
<span id='jqGui-form-field-Text-cfg-componentCls'>		/**
</span>		 * @cfg
		 * @inheritdoc
		 */
		componentCls : 'jqGui-form-field-text',
		
		
<span id='jqGui-form-field-Text-property-S-inputEl'>		/**
</span>		 * @protected
		 * @property {jQuery} $inputEl
		 * 
		 * The &amp;lt;input&amp;gt; element; the text field. Will only be available after render.
		 */
		
<span id='jqGui-form-field-Text-property-focused'>		/**
</span>		 * @protected
		 * @property {Boolean} focused
		 * 
		 * Flag which is set to `true` while the TextField is focused.
		 */
		focused : false,
		
<span id='jqGui-form-field-Text-property-S-emptyTextEl'>		/**
</span>		 * @protected
		 * @property {jQuery} $emptyTextEl
		 * 
		 * The element that holds the {@link #emptyText}, which is shown over the {@link #$inputEl}
		 * when the field is empty.
		 */
		
		
<span id='jqGui-form-field-Text-method-initComponent'>		/**
</span>		 * @inheritdoc
		 */
		initComponent : function() {
			this._super( arguments );
			
			this.addEvents(
<span id='jqGui-form-field-Text-event-keydown'>				/**
</span>				 * Fires when a key is pressed down in the field.
				 * 
				 * @event keydown
				 * @param {jqGui.form.field.Field} field This TextField object.
				 * @param {jQuery.Event} evt The jQuery event object for the event.
				 */
				'keydown',
				
<span id='jqGui-form-field-Text-event-keyup'>				/**
</span>				 * Fires when a key is pressed and let up in the field.
				 * 
				 * @event keyup
				 * @param {jqGui.form.field.Field} field This TextField object.
				 * @param {jQuery.Event} evt The jQuery event object for the event.
				 */
				'keyup',
				
<span id='jqGui-form-field-Text-event-keypress'>				/**
</span>				 * Fires when a key is pressed in the field.
				 * 
				 * @event keypress
				 * @param {jqGui.form.field.Field} field This TextField object.
				 * @param {jQuery.Event} evt The jQuery event object for the event.
				 */
				'keypress'
			);
			
			// If a value was provided, and it is not a string, convert it to one now. normalizeValue handles all datatypes.
			this.value = this.normalizeValue( this.value );
		},
		
		
<span id='jqGui-form-field-Text-method-onRender'>		/**
</span>		 * @inheritdoc
		 */
		onRender : function( container ) {
			// Call superclass onRender()
			this._super( arguments );
			
			// Create the input field, and append it to the $inputContainerEl with the 'text' css class
			var $inputEl = this.$inputEl = this.createInputEl().appendTo( this.$inputContainerEl );
			
			// Add event handlers to the input element
			$inputEl.on( {
				change   : _.bind( function( evt ) { this.onChange( this.getValue() ); }, this ),  // Call onChange() with the new value
				focus    : _.bind( this.onFocus, this ),
				blur     : _.bind( this.onBlur, this ),
				keydown  : _.bind( this.onKeyDown, this ),
				keyup    : _.bind( this.onKeyUp, this ),
				keypress : _.bind( this.onKeyPress, this )
			} );
			
			// Set up the empty text element. This element is absolutely positioned in the inputContainer, and is initially hidden.
			this.$emptyTextEl = jQuery( '&lt;div class=&quot;' + this.componentCls + '-emptyText&quot;&gt;' + this.emptyText + '&lt;/div&gt;' )
				.on( 'click', function() { $inputEl.focus(); } )  // when the emptyText itself is clicked, focus the text field
				.appendTo( this.$inputContainerEl );
			
			this.handleEmptyText();
		},
		
		
<span id='jqGui-form-field-Text-method-createInputEl'>		/**
</span>		 * Overridable method for creating the input element for the TextField. This may be overrided in a subclass for
		 * a different implementation than the regular &amp;lt;input type=&quot;text&quot;&amp;gt; element.  The implementation should
		 * add the field's &quot;id&quot; ({@link #inputId}) and &quot;name&quot; ({@link #inputName}) properties, and populate the field's
		 * initial {@link #value}.
		 * 
		 * @protected
		 * @return {jQuery}
		 */
		createInputEl : function() {
			var value = Html.encode( this.value || &quot;&quot; );
			return jQuery( [ 
				'&lt;input type=&quot;text&quot;',
				' id=&quot;' + this.inputId + '&quot;',
				' name=&quot;' + this.inputName + '&quot;',
				' class=&quot;' + this.componentCls + '-input&quot;',
				' value=&quot;' + value + '&quot;',
				( this.readOnly ? ' readonly=&quot;readonly&quot;' : '' ),
				'/&gt;'
			].join( &quot;&quot; ) );
		},
		
		
<span id='jqGui-form-field-Text-method-getInputEl'>		/**
</span>		 * Retrieves the input element from the TextField. Use only if absolutely needed however, otherwise relying on the public
		 * interface to this class to perform common tasks such as getting/setting the value, or focusing/blurring the field.  
		 * This is mainly an accessor for the bevhavior state objects that operate on this class. The input element will not be
		 * available until the TextField has been rendered.
		 * 
		 * @return {jQuery} The input element if the component is rendered, or null if it is not.
		 */
		getInputEl : function() {
			return this.$inputEl || null;
		},
		
		
<span id='jqGui-form-field-Text-method-normalizeValue'>		/**
</span>		 * Normalizes the value provided to a valid TextField value. Converts undefined/null into an empty string,
		 * and numbers/booleans/objects into their string form.
		 * 
		 * @protected
		 * @param {Mixed} value
		 * @return {String}
		 */
		normalizeValue : function( value ) {
			// Normalize undefined/null to an empty string, and numbers/booleans/objects to their string representation.
			// Otherwise, return string values unchanged.
			if( typeof value === 'undefined' || value === null ) {
				return &quot;&quot;;
			} else if( typeof value !== 'string' ) {
				return value.toString();
			} else {
				return value;
			}
		},
		
		
<span id='jqGui-form-field-Text-method-setValue'>		/**
</span>		 * Implementation of {@link jqGui.form.field.Field Field}'s setValue() method, which sets the value to the field.
		 * 
		 * @param {String} value The value of the field.
		 */
		setValue : function( value ) {
			value = this.normalizeValue( value );
			
			if( !this.rendered ) {
				this.value = value;  // If the Component has not yet been rendered (i.e. the Field has not yet been created), store the value as the initial value to set.
				
			} else {
				this.$inputEl.val( value );
			}
			
			// Run onchange, to notify listeners of a change
			this.onChange( value );
		},
		
		
<span id='jqGui-form-field-Text-method-getValue'>		/**
</span>		 * Implementation of {@link jqGui.form.field.Field Field}'s getValue() method, which returns the value of the field.
		 * 
		 * @return {String} The value of the field.
		 */
		getValue : function() {
			if( !this.rendered ) {
				// If the value was set before the Component has been rendered (i.e. before the Field has been created), return that.
				return this.value;
				
			} else {
				return this.$inputEl.val();
			}
		},
		
		
<span id='jqGui-form-field-Text-method-setEmptyText'>		/**
</span>		 * Sets the {@link #emptyText} for the Field.
		 * 
		 * @param {Mixed} emptyText The empty text to set to the Field.
		 */
		setEmptyText : function( emptyText ) {
			this.emptyText = emptyText;
			
			if( this.rendered ) {
				this.$emptyTextEl.html( emptyText );
			}
		},
		
		
<span id='jqGui-form-field-Text-method-getEmptyText'>		/**
</span>		 * Retrieves the {@link #emptyText} of the Field.
		 * 
		 * @return {Mixed} The {@link #emptyText} that was specified for the Field, or set using {@link #setEmptyText}.
		 */
		getEmptyText : function() {
			return this.emptyText;
		},
		
		
<span id='jqGui-form-field-Text-method-select'>		/**
</span>		 * Selects the text in the TextField.
		 */
		select : function() {
			this.$inputEl.select();
		},
		
		
<span id='jqGui-form-field-Text-method-onChange'>		/**
</span>		 * Extension of onChange template method used to handle the {@link #emptyText}.
		 *
		 * @protected
		 */
		onChange : function() {
			this.handleEmptyText();
			
			this._super( arguments );
		},
		
		
<span id='jqGui-form-field-Text-method-focus'>		/**
</span>		 * Focuses the text field.
		 * 
		 * @chainable
		 */
		focus : function() {
			this.$inputEl.focus();
			
			return this._super( arguments );
		},
		
		
<span id='jqGui-form-field-Text-method-blur'>		/**
</span>		 * Blurs the text field.
		 * 
		 * @chainable
		 */
		blur : function() {
			this.$inputEl.blur();
			
			return this._super( arguments );
		},
		
		
<span id='jqGui-form-field-Text-method-onFocus'>		/**
</span>		 * @inheritdoc
		 */
		onFocus : function() {
			this.focused = true;
			this.handleEmptyText();
			
			// If the selectOnFocus config is true, select the text
			if( this.selectOnFocus ) {
				this.select();
			}
			
			this._super( arguments );
		},
		
		
<span id='jqGui-form-field-Text-method-onBlur'>		/**
</span>		 * @inheritdoc
		 */
		onBlur : function() {
			this.focused = false;
			this.handleEmptyText();
			
			this._super( arguments );
		},
		
		
<span id='jqGui-form-field-Text-method-isFocused'>		/**
</span>		 * Determines if the TextField is currently focused.
		 * 
		 * @return {Boolean} `true` if the TextField is currently focused, false otherwise.
		 */
		isFocused : function() {
			return this.focused;
		},
		
		
<span id='jqGui-form-field-Text-method-onKeyDown'>		/**
</span>		 * Handles a keydown event in the text field. 
		 * 
		 * @protected
		 * @param {jQuery.Event} evt The jQuery event object for the event.
		 */
		onKeyDown : function( evt ) {
			this.fireEvent( 'keydown', this, evt ); 
		},
		
		
<span id='jqGui-form-field-Text-method-onKeyUp'>		/**
</span>		 * Handles a keyup event in the text field. 
		 * 
		 * @protected
		 * @param {jQuery.Event} evt The jQuery event object for the event.
		 */
		onKeyUp : function( evt ) {
			this.fireEvent( 'keyup', this, evt );
		},
		
		
<span id='jqGui-form-field-Text-method-onKeyPress'>		/**
</span>		 * Handles a keypress in the text field. 
		 * 
		 * @protected
		 * @param {jQuery.Event} evt The jQuery event object for the event.
		 */
		onKeyPress : function( evt ) {
			this.fireEvent( 'keypress', this, evt ); 
		},
		
		
		// ---------------------------------------
		
		// Empty Text Handling Utility Methods
		
<span id='jqGui-form-field-Text-method-handleEmptyText'>		/**
</span>		 * Checks the TextField to see if it's empty, and if so shows the {@link #emptyText}.
		 * 
		 * @protected
		 */
		handleEmptyText : function() {
			if( this.rendered ) {
				// Field is not focused and its value is empty, show the empty text. Otherwise, hide it.
				this.$emptyTextEl[ ( !this.focused &amp;&amp; this.getValue() === &quot;&quot; ) ? 'show' : 'hide' ]();
			}
		}
		
	} );
	
	
	ComponentManager.registerType( 'textfield', TextField );

	return TextField;
	
} );</pre>
</body>
</html>
